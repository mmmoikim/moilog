<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>1. 브라우저 구성과 엔진 | MOILOG</title>
    <meta name="description" content="Hello! I&#39;m web developer. this is study blog.">
    <meta name="google-site-verification" content="Np5Qu68ys0COB1T9fZ8rfxfrr_SLcHqzfmu9Q03K8YY">
    
    <link rel="preload" href="/moilog/assets/css/0.styles.6ef3f76f.css" as="style"><link rel="preload" href="/moilog/assets/js/app.ae515986.js" as="script"><link rel="preload" href="/moilog/assets/js/6.b4a4f99c.js" as="script"><link rel="prefetch" href="/moilog/assets/js/10.47d880df.js"><link rel="prefetch" href="/moilog/assets/js/11.dff6fbc0.js"><link rel="prefetch" href="/moilog/assets/js/12.67e84a35.js"><link rel="prefetch" href="/moilog/assets/js/13.eb2c8d3f.js"><link rel="prefetch" href="/moilog/assets/js/14.b66233e1.js"><link rel="prefetch" href="/moilog/assets/js/15.42b1e262.js"><link rel="prefetch" href="/moilog/assets/js/16.38463800.js"><link rel="prefetch" href="/moilog/assets/js/17.d9e791e4.js"><link rel="prefetch" href="/moilog/assets/js/18.3d9a233f.js"><link rel="prefetch" href="/moilog/assets/js/19.b4485bbc.js"><link rel="prefetch" href="/moilog/assets/js/20.e9f46bc7.js"><link rel="prefetch" href="/moilog/assets/js/21.e0dcecb4.js"><link rel="prefetch" href="/moilog/assets/js/22.0c1252c7.js"><link rel="prefetch" href="/moilog/assets/js/23.fb1571df.js"><link rel="prefetch" href="/moilog/assets/js/24.aa6c24c2.js"><link rel="prefetch" href="/moilog/assets/js/25.61f24dec.js"><link rel="prefetch" href="/moilog/assets/js/26.0c042d9c.js"><link rel="prefetch" href="/moilog/assets/js/27.02c89de4.js"><link rel="prefetch" href="/moilog/assets/js/28.b4444a46.js"><link rel="prefetch" href="/moilog/assets/js/29.c74e9844.js"><link rel="prefetch" href="/moilog/assets/js/3.2d797fd0.js"><link rel="prefetch" href="/moilog/assets/js/30.bc640131.js"><link rel="prefetch" href="/moilog/assets/js/31.9dba47c1.js"><link rel="prefetch" href="/moilog/assets/js/32.2e1c33c2.js"><link rel="prefetch" href="/moilog/assets/js/33.a94204db.js"><link rel="prefetch" href="/moilog/assets/js/34.473e8ca3.js"><link rel="prefetch" href="/moilog/assets/js/35.87817426.js"><link rel="prefetch" href="/moilog/assets/js/36.5c0a4dae.js"><link rel="prefetch" href="/moilog/assets/js/37.d97fa9ca.js"><link rel="prefetch" href="/moilog/assets/js/38.80d4853a.js"><link rel="prefetch" href="/moilog/assets/js/39.920784a2.js"><link rel="prefetch" href="/moilog/assets/js/4.9adc46b6.js"><link rel="prefetch" href="/moilog/assets/js/40.2ad76590.js"><link rel="prefetch" href="/moilog/assets/js/41.64ecf26b.js"><link rel="prefetch" href="/moilog/assets/js/42.19e25c0a.js"><link rel="prefetch" href="/moilog/assets/js/43.af9173eb.js"><link rel="prefetch" href="/moilog/assets/js/44.6d8303aa.js"><link rel="prefetch" href="/moilog/assets/js/45.ec931762.js"><link rel="prefetch" href="/moilog/assets/js/46.c455561e.js"><link rel="prefetch" href="/moilog/assets/js/47.1b6ebe90.js"><link rel="prefetch" href="/moilog/assets/js/48.7e50bdca.js"><link rel="prefetch" href="/moilog/assets/js/49.eeb5be00.js"><link rel="prefetch" href="/moilog/assets/js/5.9c1ee8f1.js"><link rel="prefetch" href="/moilog/assets/js/50.8d4d21e5.js"><link rel="prefetch" href="/moilog/assets/js/51.7f4c6f81.js"><link rel="prefetch" href="/moilog/assets/js/52.27c9acd3.js"><link rel="prefetch" href="/moilog/assets/js/53.3dccbb50.js"><link rel="prefetch" href="/moilog/assets/js/7.77d08323.js"><link rel="prefetch" href="/moilog/assets/js/8.07a7ae9c.js"><link rel="prefetch" href="/moilog/assets/js/9.e07a472c.js"><link rel="prefetch" href="/moilog/assets/js/vendors~docsearch.a77ba3c3.js">
    <link rel="stylesheet" href="/moilog/assets/css/0.styles.6ef3f76f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/moilog/" class="home-link router-link-active"><img src="/moilog/logo.png" class="logo"></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/moilog/" class="nav-link">Home</a></div><div class="nav-item"><a href="/moilog/post/list.html" class="nav-link">Post</a></div> <a href="https://github.com/mmmoikim/moilog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/moilog/" class="nav-link">Home</a></div><div class="nav-item"><a href="/moilog/post/list.html" class="nav-link">Post</a></div> <a href="https://github.com/mmmoikim/moilog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading"><span>WEB</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>REACT</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>VUE</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>javascript</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>css</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading open"><span>how javascript work</span> <span class="arrow down"></span></p> <ul class="sidebar-group-items"><li><a href="/moilog/post/hjw/hjw-1-browser.html" class="active sidebar-link">1. 브라우저 구성과 엔진</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/moilog/post/hjw/hjw-1-browser.html#브라우저-구성" class="sidebar-link">브라우저 구성</a></li><li class="sidebar-sub-header"><a href="/moilog/post/hjw/hjw-1-browser.html#브라우저-엔진" class="sidebar-link">브라우저 엔진</a></li><li class="sidebar-sub-header"><a href="/moilog/post/hjw/hjw-1-browser.html#v8" class="sidebar-link">V8</a></li><li class="sidebar-sub-header"><a href="/moilog/post/hjw/hjw-1-browser.html#hidden-class" class="sidebar-link">Hidden class</a></li><li class="sidebar-sub-header"><a href="/moilog/post/hjw/hjw-1-browser.html#인라인캐싱" class="sidebar-link">인라인캐싱</a></li><li class="sidebar-sub-header"><a href="/moilog/post/hjw/hjw-1-browser.html#이벤트-루프와-테스트-큐" class="sidebar-link">이벤트 루프와 테스트 큐</a></li><li class="sidebar-sub-header"><a href="/moilog/post/hjw/hjw-1-browser.html#zero-delays" class="sidebar-link">Zero delays</a></li><li class="sidebar-sub-header"><a href="/moilog/post/hjw/hjw-1-browser.html#마이크로테스크" class="sidebar-link">마이크로테스크</a></li><li class="sidebar-sub-header"><a href="/moilog/post/hjw/hjw-1-browser.html#job-queue" class="sidebar-link">Job Queue</a></li><li class="sidebar-sub-header"><a href="/moilog/post/hjw/hjw-1-browser.html#reference" class="sidebar-link">reference</a></li></ul></li><li><a href="/moilog/post/hjw/hjw-2-memory.html" class="sidebar-link">2. 메모리</a></li><li><a href="/moilog/post/hjw/hjw-3-websocket.html" class="sidebar-link">3. websockek과 HTTP/2 + SSE</a></li><li><a href="/moilog/post/hjw/hjw-4-wasm.html" class="sidebar-link">4. 웹어셈블리</a></li><li><a href="/moilog/post/hjw/hjw-5-webworker.html" class="sidebar-link">5. webworker</a></li><li><a href="/moilog/post/hjw/hjw-6-webpush.html" class="sidebar-link">6. web push notifications</a></li><li><a href="/moilog/post/hjw/hjw-rendering.html" class="sidebar-link">rendering</a></li><li><a href="/moilog/post/hjw/hjw-references.html" class="sidebar-link">references</a></li></ul></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>webpack</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>java</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Etc</span> <span class="arrow right"></span></p> <!----></div></li></ul> </div> <div class="page"><div class="page-mask"> <div class="content"><h1 id="_1-브라우저-구성과-엔진"><a href="#_1-브라우저-구성과-엔진" aria-hidden="true" class="header-anchor">#</a> 1. 브라우저 구성과 엔진</h1> <ul><li><a href="#1-%EB%B8%8C%EB%9D%BC%EC%9A%B0%EC%A0%80-%EA%B5%AC%EC%84%B1%EA%B3%BC-%EC%97%94%EC%A7%84">1. 브라우저 구성과 엔진</a> <ul><li><a href="#%EB%B8%8C%EB%9D%BC%EC%9A%B0%EC%A0%80-%EA%B5%AC%EC%84%B1">브라우저 구성</a> <ul><li><a href="#nodejs-%EA%B5%AC%EC%84%B1">Node.js 구성</a></li></ul></li> <li><a href="#%EB%B8%8C%EB%9D%BC%EC%9A%B0%EC%A0%80-%EC%97%94%EC%A7%84">브라우저 엔진</a></li> <li><a href="#v8">V8</a></li> <li><a href="#hidden-class">Hidden class</a></li> <li><a href="#%EC%9D%B8%EB%9D%BC%EC%9D%B8%EC%BA%90%EC%8B%B1">인라인캐싱</a></li> <li><a href="#%EC%9D%B4%EB%B2%A4%ED%8A%B8-%EB%A3%A8%ED%94%84%EC%99%80-%ED%85%8C%EC%8A%A4%ED%8A%B8-%ED%81%90">이벤트 루프와 테스트 큐</a></li> <li><a href="#zero-delays">Zero delays</a></li> <li><a href="#%EB%A7%88%EC%9D%B4%ED%81%AC%EB%A1%9C%ED%85%8C%EC%8A%A4%ED%81%AC">마이크로테스크</a></li> <li><a href="#job-queue">Job Queue</a></li> <li><a href="#reference">reference</a></li></ul></li></ul> <h2 id="브라우저-구성"><a href="#브라우저-구성" aria-hidden="true" class="header-anchor">#</a> 브라우저 구성</h2> <p><img src="/moilog/assets/img/how-javascript-work-1.8777e585.png" alt="브라우저"></p> <ul><li>WebAPI : 비동기 호출(<code>setTimeout</code>, <code>XMLHttpRequest</code>)과 <code>DOM</code>과 같은 기능을 제공한다.</li> <li>이벤트루프와 태스트큐 : 엔진 외부에 구현되어 있고 비동기 방식으로 동시성을 제공한다.</li> <li>javascript 엔진 : 메모리 힙과 콜스택으로 구성된다.</li></ul> <h3 id="node-js-구성"><a href="#node-js-구성" aria-hidden="true" class="header-anchor">#</a> Node.js 구성</h3> <p><img src="/moilog/assets/img/how-javascript-work-2.780bb1bd.jpg" alt="Node.js"></p> <ul><li>api 콜백을 LIBUV(node.js 비동기 IO 라이브러리)가 지원하는 이벤트 루프에서 처리한다.</li></ul> <h2 id="브라우저-엔진"><a href="#브라우저-엔진" aria-hidden="true" class="header-anchor">#</a> 브라우저 엔진</h2> <p><img src="/moilog/assets/img/how-javascript-work-3.4064394f.png" alt="브라우저엔진"></p> <ul><li>Mozilla Firefox : Spidermonkey</li> <li>Microsoft Edge : Chakra / ChakraCore</li> <li>Apple Safari : JavaScriptCore</li> <li>Google 크롬, Node.js : V8</li></ul> <hr> <ul><li>메모리힙과 콜스택으로 구성된다.</li> <li>콜스택 : 함수를 호출 할 때 함수의 arguments 와 지역변수로 구성된 <code>스택 프레임</code>을 생성해서 스택에 쌓고 컴파일 시 실행된다.<br>
스택은 stack overflow가 발생 할 수 있고 에러가 발생하면 stack trace(현재 스택 추적 <code>console.trace</code>)를 할 수 있다.</li> <li>메모리 힙 : 동적으로 메모리를 할당해야 하는 경우는 구조화 되지 않은 공간인 Heap에 할당 되어 런타임에 실행 된다.(object, string)</li></ul> <h2 id="v8"><a href="#v8" aria-hidden="true" class="header-anchor">#</a> V8</h2> <ul><li>속도를 높히기 위해 인터프린터 대신 JIT(just in time) 컴파일러를 구현해 놓아서 javascript 코드 실행 시에 byte코드나 중간코드를 구현하지 않고 기계코드로 직접 컴파일 한다.</li> <li>두가지 컴파일러
<ul><li>full-codegen : 간단하고 빠른 컴파일러</li> <li>Crankshaft : 복잡하고 최적화하는 컴파일러</li></ul></li> <li>내부적으로 여러 스레드를 사용한다.
<ul><li>코드를 가져와 컴파일하고 실행하는 주 스레드.</li> <li>컴파일을 위한 스레드</li> <li>런타임에게 어떤 메소드에 시간을 많이 쓸지 알려주는 프로파일러 쓰레드</li> <li>가비지콜렉터를 다루는 스레드</li></ul></li> <li>코드를 실행하면 full-codegen가 바로 기계코드로 변환하고<br>
프로파일러 스레드는 메소드에게 최적화 된 데이터들을 모은다.</li> <li>Crankshaft는 다른 스레드에서 실행되며<br>
자바스크립트 abstract syntax tree를 static single-assignment 정적 단일 할당 (SSA) 으로 불리는 Hydrogen 로 변환하고 (SSA는 컴파일러 안에서 중간언어로 사용된다)
인라이닝, Hydrogen graph 최적화를 한 후 기계어로 변환한다.</li> <li><a href="https://wingolog.org/archives/2011/08/02/a-closer-look-at-crankshaft-v8s-optimizing-compiler" target="_blank" rel="noopener noreferrer">Crankshaft<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h2 id="hidden-class"><a href="#hidden-class" aria-hidden="true" class="header-anchor">#</a> Hidden class</h2> <ul><li>자바스크립트는 동적타이핑 언어이다. 컴파일시 메모리 오프셋을 결정 할 수 없으며 코드를 실행 할 때(런타임) 상황에 따라서 데이터 타입이 정해진다.</li> <li>이 같은 이유로 객체 프로퍼티를 접근 할 때 마다 사전 같은 구조에서 속성를 찾아야 하고 이를 위한 동적 탐색(dynamic lookup)을 하게 되는데 이 과정에서 구현 방식에 따라 비용이 달라진다.</li> <li>V8은 hidden class를 사용해서 프로퍼티의 오프셋을 가지고 값을 업데이트 하면서 dynamic lookup을 회피하고 있다.</li> <li><a href="https://engineering.linecorp.com/ko/blog/v8-hidden-class/" target="_blank" rel="noopener noreferrer">동작과정<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>속성을 참조하는 순서에 따라 다른 히든클래스가 생성되기 때문에 같은 순서로 초기화 하는것이 좋다.</li> <li>객체를 초기화 할 때 사용하는 모든 속성을 할당하는것이 좋다. 추가로 할 당하면 히든 클래스가 변하기 때문에</li></ul> <h2 id="인라인캐싱"><a href="#인라인캐싱" aria-hidden="true" class="header-anchor">#</a> 인라인캐싱</h2> <ul><li>메소드가 호출 될 때마다 객체의 히든클래스를 찾아서 오프셋값을 계산해야하기 때문에 이것을 캐싱처리 한다.</li> <li>두번의 호출에서 한 메소드에서 같은 객체에 접근했다면 그 객체의 히든클래스를 참조하는 것을 건너 뛰고 스스로 해당 메소드 객체 포인터 속성에 오프셋을 저장해 놓는다.</li> <li>값을 접근하는 순서에 따라 히든클래스가 달라지기 때문에 캐싱을 사용하지 못하는 경우가 있다.</li></ul> <h2 id="이벤트-루프와-테스트-큐"><a href="#이벤트-루프와-테스트-큐" aria-hidden="true" class="header-anchor">#</a> 이벤트 루프와 테스트 큐</h2> <ul><li>모든 비동기 함수는 콜백 함수를 태스크 큐에 추가한다.</li> <li>이벤트 루프는 '현재 실행중인 태스크가 없을 때'(주로 호출 스택이 비워졌을 때) 태스크 큐의 첫 번째 태스크를 꺼내와 실행한다.</li> <li><a href="http://latentflip.com/loupe/?code=JC5vbignYnV0dG9uJywgJ2NsaWNrJywgZnVuY3Rpb24gb25DbGljaygpIHsKICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gdGltZXIoKSB7CiAgICAgICAgY29uc29sZS5sb2coJ1lvdSBjbGlja2VkIHRoZSBidXR0b24hJyk7ICAgIAogICAgfSwgMjAwMCk7Cn0pOwoKY29uc29sZS5sb2coIkhpISIpOwoKc2V0VGltZW91dChmdW5jdGlvbiB0aW1lb3V0KCkgewogICAgY29uc29sZS5sb2coIkNsaWNrIHRoZSBidXR0b24hIik7Cn0sIDUwMDApOwoKY29uc29sZS5sb2coIldlbGNvbWUgdG8gbG91cGUuIik7!!!PGJ1dHRvbj5DbGljayBtZSE8L2J1dHRvbj4%3D" target="_blank" rel="noopener noreferrer">데모 코드<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">while</span><span class="token punctuation">(</span>queue<span class="token punctuation">.</span><span class="token function">waitForMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  queue<span class="token punctuation">.</span><span class="token function">processNextMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>A 콜백이 큐에서 제거되고 B 콜백이 실행 될때 B에서 에러가 발생하므로 A콜백에 있는 try-catch 문에 잡히지 않는다.</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'.btn'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// (A)</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        $<span class="token punctuation">.</span><span class="token function">getJSON</span><span class="token punctuation">(</span><span class="token string">'/api/members'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// (B)</span>
            <span class="token comment">// 에러 발생 코드</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Error : '</span> <span class="token operator">+</span> e<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>태스크 큐 작업이 끝나는 시점에 랜더링이 되기 때문에 하나의 콜백 안에 랜더링이 변하는 로직을 넣으면 생각처럼 작동 하지 않는다.</li> <li>태스크 큐에 <code>setTimeout</code>로 작업을 분리해서 넣거나 <code>setImmediate</code>이나 <code>nextTick</code> 으로 해결 할 수 있다.</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'.btn'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">showWaitingMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">longTakingProcess</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">hideWaitingMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">showResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'.btn'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">showWaitingMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">longTakingProcess</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">hideWaitingMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">showResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="zero-delays"><a href="#zero-delays" aria-hidden="true" class="header-anchor">#</a> Zero delays</h2> <ul><li><code>setTimeout(fn, 0)</code> 은 실제로 주어지 시간 뒤에 함수를 실행 하지 않는다.</li> <li><code>setTimeout</code>에 대한 특정 시간 제한을 지정 했더라도 대기중인 메시지의 모든 코드가 완료 될 때까지 대기해야 한다.</li></ul> <h2 id="마이크로테스크"><a href="#마이크로테스크" aria-hidden="true" class="header-anchor">#</a> 마이크로테스크</h2> <ul><li>프로미스는 마이크로테스크로 등록 되는데 이는 일반 태스크큐 보다 높은 우선순위를 지닌 테스크이다.</li></ul> <h2 id="job-queue"><a href="#job-queue" aria-hidden="true" class="header-anchor">#</a> Job Queue</h2> <ul><li>es6에서 도입 됐으며 Promises 에서 쓰임. 마이크로테스크와는 별도의 개념.</li> <li>함수 안에서 프로미스가 리졸브 됐다면 그 함수가 끝나자 마자 바로 실행 된다.</li> <li>현재 call stack이 비워졌을때 job이 실행이 되고 다른 잡이 끼어들지 못한다</li> <li><a href="https://flaviocopes.com/javascript-event-loop/#es6-job-queue" target="_blank" rel="noopener noreferrer">참조<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="http://www.ecma-international.org/ecma-262/6.0/#sec-jobs-and-job-queues" target="_blank" rel="noopener noreferrer">참조<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h2 id="reference"><a href="#reference" aria-hidden="true" class="header-anchor">#</a> reference</h2> <ul><li><a href="https://blog.sessionstack.com/how-does-javascript-actually-work-part-1-b0bacc073cf" target="_blank" rel="noopener noreferrer">How JavaScript works: an overview of the engine, the runtime, and the call stack<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://blog.sessionstack.com/how-javascript-works-inside-the-v8-engine-5-tips-on-how-to-write-optimized-code-ac089e62b12e" target="_blank" rel="noopener noreferrer">How JavaScript works: inside the V8 engine + 5 tips on how to write optimized code<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/EventLoop" target="_blank" rel="noopener noreferrer">MDN web docs<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://meetup.toast.com/posts/89" target="_blank" rel="noopener noreferrer">toast meetup<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div> <div id="disqus_thread"></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/mmmoikim/moilog/edit/master/docs/post/hjw/hjw-1-browser.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">7/5/2019, 8:35:09 AM</span></div></div> <div class="page-nav"><p class="inner"><span class="prev">
          ← <a href="/moilog/post/css/scss.html" class="prev">
            scss
          </a></span> <span class="next"><a href="/moilog/post/hjw/hjw-2-memory.html">
            2. 메모리
          </a> →
        </span></p> </div></div></div></div></div>
    <script src="/moilog/assets/js/app.ae515986.js" defer></script><script src="/moilog/assets/js/6.b4a4f99c.js" defer></script>
  </body>
</html>
